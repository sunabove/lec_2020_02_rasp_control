<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AlphaBot</title>
	<link href="/bootstrap.min.css" rel="stylesheet" media="screen">
	<script src="/jquery-3.6.0.min.js"></script>
	<script src="/popper.min.js"></script>
	<script src="/bootstrap.min.js"></script> 
    <script> 
		
        $(function(){
			// tooltip init
			var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
			var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
				return new bootstrap.Tooltip(tooltipTriggerEl)
			});
			// -- tooltip init

			// tab
			$('#myTab a').on('click', function (e) {
				e.preventDefault()
				$(this).tab('show')
			})
			// -- tab1

            $(".motor").bind( "mousedown", function(){
                $.post("/cmd",{ cmd: this.id, speed: $("#speed").val() }, function(data,status){
                });
            });

			$("motor").bind( "mouseup",function(){
                $.post("/cmd",{ cmd:"stop" }, function(data,status){
                });
            }); 

			$("button.servo").bind( "mousedown", function(){
                $.post("/cmd",{ cmd: this.id }, function(data,status){
                });
            });

			$(".menu").click( function(){
                $.post("/cmd",{ cmd: this.id }, function(data,status){
                });
            });

			function show_speed() {
				$('#speed_desc').html( $("#speed").val() )
			}

			$("#speed").click( function(){
				show_speed();

                $.post("/cmd",{ cmd: 'min_spped', val: $(this).val() }, function(data,status){
                });
            });

			show_speed();
        });
		
    </script>

	<style type="text/css">
    </style>
	
</head>

<body>

<div id="container" class="container text-center" >
	<br/>
	<h4>AlphaBot Control v 1.0.03</h4>

	<div class="container" class="text-center">
		<div class="row">
			<div class="col">
				<img src="{{ url_for('video_feed') }}" width="640" height="480" usemap_false="#workmap" />
				<map name="workmap">
					<area id="forward"    class="motor" shape="poly" coords="0,0, 213,160, 426,160,  640,0" 		title="Foreward"  _href="#foreward" >
					<area id="turn_left"  class="motor" shape="poly" coords="0,0, 213,160, 213,320,  0,640" 		title="Left"      _href="#left" >
					<area id="stop"       class="motor" shape="rect" coords="213,160,  426,320"             		title="Stop"      _href="#stop" >
					<area id="turn_right" class="motor" shape="poly" coords="640,0,  426,160,  426,320, 640,640" 	title="Right" 	  _href="#right" >
					<area id="backward"   class="motor" shape="poly" coords="0,640,  213,320,  426,320,  640,640" 	title="Backward"  _href="#backward" >
				</map>
			</div>
		</div>
	</div>

	<br/>

	<ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
		<li class="nav-item">
			<a class="nav-link active_" id="motor-tab" data-toggle="tab" href="#motor" role="tab" aria-controls="motor" aria-selected="false">Motor</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" id="servo-tab" data-toggle="tab" href="#servo" role="tab" aria-controls="servo" aria-selected="false">Servo</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" id="obstacle-tab" data-toggle="tab" href="#obstacle" role="tab" aria-controls="obstacle" aria-selected="false">장애물 회피</a>
		</li>
		<li class="nav-item">
			<a class="nav-link" id="line_sensor-tab" data-toggle="tab" href="#line_sensor" role="tab" aria-controls="line_sensor" aria-selected="false">라인 추적 (센서)</a>
		</li>
		<li class="nav-item">
			<a class="nav-link active" id="line_camera-tab" data-toggle="tab" href="#line_camera" role="tab" aria-controls="line_camera" aria-selected="true">라인 추적 (카메라)</a>
		</li>
		&nbsp;
		<div class="btn-group">
			<button type="button" class="btn-sm btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
				메뉴
			</button>
			<ul class="dropdown-menu">
				<li><a id="stop_service" class="menu dropdown-item menu">Stop</a></li>
				<li><hr class="dropdown-divider"></li>
				<li><a id="shutdown" class="menu dropdown-item"> 라즈베리파이 종료 </a></li>
			</ul>
		</div>
	</ul>

	<br/>
				
	<div class="tab-content " id="myTabContent">
		<div class="tab-pane fade show_ active_" id="motor" role="tabpanel" aria-labelledby="motor-tab" align="center">
			<!-- # motor -->
			<table class="text-center" >
				<colgroup>
					<col width="56px" />
					<col width="56px" />
					<col width="56px" />
				</colgroup>
				<thead>
					<tr>
						<td colspan="100%" >
							<h6 class="text-center text-nowrap">Motor Control</h6>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>&nbsp;</td>
						<td>
							<button id="forward" class="motor btn btn-lg btn-primary">&uuarr;</button>
						</td>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td>
							<button id='turn_left' class="motor btn btn-lg btn-primary">&llarr;</button>
						</td>
						<td>
							<button id='stop' class="motor btn btn-lg btn-danger">Stop</button>
						</td>
						<td>
							<button id='turn_right' class="motor btn btn-lg btn-primary">&rrarr;</button>
						</td>
					</tr>
					<tr>
						<td>&nbsp;</td>
						<td>
							<button id='backward' class="motor btn btn-lg btn-primary">&ddarr;</button>
						</td>
						<td>&nbsp;</td>
					</tr>
				</tbody>
				<tfoot>
					<tr>
						<td colspan="100%">
							<br/>
							<h6>Speed : <span id="speed_desc">50</span></h6>
							<input id="speed" type="range" class="form-label" min="5" max="70" value="{{ min_speed }}" style="margin:-10px; width:100%; "  >
						</td>
					</tr>
				</tfoot>
			</table> 
			<!-- # motor -->
		</div>

		<div class="tab-pane fade" id="servo" role="tabpanel" aria-labelledby="servo-tab" align="center">
			<!-- servo -->
			<table class="text-center" >
				<colgroup>
					<col width="56px" />
					<col width="56px" />
					<col width="56px" />
				</colgroup>
				<thead>
					<tr>
						<td colspan="100%" >
							<h6 class="text-center text-nowrap">Servo Control</h6>
						</td>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>&nbsp;</td>
						<td>
							<button id="servo_up" class="servo btn btn-lg btn-success">&uuarr;</button>
						</td>
						<td>&nbsp;</td>
					</tr>
					<tr>
						<td>
							<button id='servo_left' class="servo btn btn-lg btn-success">&llarr;</button>
						</td>
						<td>
							<button id='servo_stop' class="servo btn btn-lg btn-danger">Stop</button>
						</td>
						<td>
							<button id='servo_right' class="servo btn btn-lg btn-success">&rrarr;</button>
						</td>
					</tr>
					<tr>
						<td>&nbsp;</td>
						<td>
							<button id='servo_down' class="servo btn btn-lg btn-success">&ddarr;</button>
						</td>
						<td>&nbsp;</td> 
					</tr>
				</tbody>
			</table> 
			<!-- # servo -->
		</div>

		<div class="tab-pane fade" id="obstacle" role="tabpanel" aria-labelledby="obstracle-tab">
			<!-- obstacle -->
			<button id="obstacle_sensor" class="menu btn btn-sm btn-success"> 장애물 회피 </button>
			&nbsp;
			<button id='stop' class="menu btn btn-sm btn-danger">Stop</button> 
			<!-- # obstacle -->
		</div>

		<div class="tab-pane fade" id="line_sensor" role="tabpanel" aria-labelledby="line_sensor-tab">
			<!-- line sensor -->
			<button id="line_tracking" class="menu btn btn-sm btn-success">라인 추적 (센서)</button>
			&nbsp;
			<button id='stop' class="menu btn btn-sm btn-danger">Stop</button> 
			<!-- # line sensor -->
		</div>

		<div class="tab-pane fade show active" id="line_camera" role="tabpanel" aria-labelledby="line_camera-tab" align="center">
			<!-- line camera -->
			<div style="width:300px;">
				<form>
					<div class="form-group">
						<button id="line_camera" class="menu btn btn-sm btn-success">라인 추적 (카메라)</button>
						&nbsp;
						<button id='stop' class="menu btn btn-sm btn-danger">Stop</button>
					</div>
					<br/>

					<div class="form-group text-left">
						<label for="threshold" id="threshold_desc" >Treshold : 50</label>
						<input id="threshold" type="range" class="form-label cmd" min="5" max="140" style="width:100%; "  > 
					</div>

					<!--
					<div class="form-group text-left">
						<label for="exampleInputEmail1">Email address</label>
						<input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
						<small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
					</div>
					<br/>
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="exampleCheck1">
						<label class="form-check-label" for="exampleCheck1">Check me out</label>
					</div> 
					-->
				</form>
			</div>
			<!-- # line camera -->
		</div>
	</div>

</div>

</body>
</html>
